<!DOCTYPE html>
<html>
<head>
  <title>Вход - Наперстки</title>
  <style>
    body { font-family: Arial; max-width: 400px; margin: 50px auto; padding: 20px; }
    .form-group { margin: 15px 0; }
    input { width: 100%; padding: 10px; margin: 5px 0; border: 1px solid #ddd; }
    button { background: #2196F3; color: white; padding: 12px; border: none; width: 100%; cursor: pointer; }
    button:hover { background: #0b7dda; }
  </style>
</head>
<body>
<h2>Вход в игру</h2>
<form id="loginForm">
  <div class="form-group">
    <input type="text" id="username" placeholder="Логин" required>
  </div>
  <div class="form-group">
    <input type="password" id="password" placeholder="Пароль" required>
  </div>
  <button type="submit">Войти</button>
</form>
<p>Нет аккаунта? <a href="register.html">Зарегистрироваться</a></p>

<script>
  document.getElementById('loginForm').addEventListener('submit', async function(e) {
      e.preventDefault();

      const data = {
          username: document.getElementById('username').value,
          password: document.getElementById('password').value
      };

      try {
          const response = await fetch('/auth/login', {
              method: 'POST',
              headers: {
                  'Content-Type': 'application/json'
              },
              body: JSON.stringify(data)
          });

          if (response.ok) {
              const result = await response.json();
              localStorage.setItem('jwtToken', result.token);
              alert('Вход успешен! Токен сохранен.');
              window.location.href = '/game.html';
          } else {
              const error = await response.text();
              alert('Ошибка: ' + error);
          }
      } catch (error) {
          alert('Ошибка сети: ' + error);
      }
  });
</script>
</body>
</html>